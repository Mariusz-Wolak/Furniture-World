<aura:component description="FW_ProductsDiscountManagerResults" controller="FW_ProductsController"
                implements="flexipage:availableForAllPageTypes">

    <aura:attribute name="results" type="Object[]" access="global"/>
    <aura:attribute name="discountType" type="String" access="global"/>
    <aura:attribute name="discountValue" type="String" access="global"/>
    <aura:attribute name="pricebooksList" type="Object[]" access="global"/>
    <aura:attribute name="pricebookStartDate" type="String" access="global"/>
    <aura:attribute name="pricebookEndDate" type="String" access="global"/>
    <aura:attribute name="productsToDiscountList" type="Object[]" access="global"/>
    <aura:attribute name="standardPricebookId" type="String" access="global"/>

    <aura:registerEvent name="FW_ProductsDiscountManagerSelectAllEvent" type="c:FW_ProductsDiscountManagerSelectAllEvent"/>

    <aura:handler name="init" value="{!this}" action="{!c.onInit}"/>
    <aura:handler name="FW_SendProductsToDiscountManager" event="c:FW_SendProductsToDiscountManager"
                  action="{!c.receiveSearchResults}"/>
    <aura:handler event="c:FW_ProductsDiscountManagerNewPricebook" action="{!c.receiveNewPricebook}"/>
    <aura:handler name="FW_DiscountManagerProductToDiscountEvent" event="c:FW_DiscountManagerProductToDiscountEvent" action="{!c.receiveProductToDiscount}"/>

    <lightning:card class="card">
        <div class="slds-grid">
            <div class="searchBarDiv slds-col slds-size_4-of-12">
                <c:FW_ProductsDiscountManagerSearchBar aura:id="searchBar"/>
            </div>

            <div class="slds-col slds-size_1-of-12"/>

            <div class="slds-col slds-size_7-of-12">
                <h1 class="header">{!$Label.c.Set_Discount}</h1>

                <div class="infoDiv slds-grid slds-wrap">
                    <div class="slds-col slds-size_8-of-12"/>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning:input value="{!v.discountValue}" placeholder="{!$Label.c.Value}" onchange="{!c.compute}"
                                         label="{!$Label.c.Value}"/>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning:select aura:id="discountType" onchange="{!c.compute}" label="{!$Label.c.Type}">
                            <option value="%">%</option>
                            <option value="{!$Label.c.Raw}">{!$Label.c.Raw}</option>
                        </lightning:select>
                    </div>
                </div>

                <div class="infoDiv slds-grid">
                    <div class="slds-col slds-size_4-of-12">
                        <lightning:select aura:id="pricebooksSelect" onchange="{!c.getPricebook}" label="{!$Label.c.Pricebook}">
                            <aura:iteration items="{!v.pricebooksList}" var="pricebook">
                                <option value="{!pricebook.Id}" label="{!pricebook.Name}"/>
                            </aura:iteration>
                        </lightning:select>
                    </div>
                    <div class="slds-col slds-size_3-of-12">
                        <lightning:input value="{!v.pricebookStartDate}" placeholder="{!$Label.c.Start_Date}" disabled="true"
                                         label="{!$Label.c.Start_Date}"/>
                    </div>
                    <div class="slds-col slds-size_3-of-12">
                        <lightning:input value="{!v.pricebookEndDate}" placeholder="{!$Label.c.End_Date}" disabled="true"
                                         label="{!$Label.c.End_Date}"/>
                    </div>
                    <div class="button slds-col slds-size_2-of-12 slds-text-align_right">
                        <lightning:button label="{!$Label.c.Save}" onclick="{!c.setDiscount}"/>
                    </div>
                </div>
            </div>
        </div>

        <aura:if isTrue="{!not(empty(v.results))}">
            <div class="checkboxDiv">
                <div class="checkbox">
                    <ui:inputCheckbox aura:id="selectAllCheckbox" change="{!c.selectAll}"/>
                </div>
                <div class="checkboxLabel">{!$Label.c.Select_All}</div>
            </div>
            <div class="scroll slds-scrollable_y" style="display: block; clear: both">
                <aura:iteration items="{!v.results}" var="product">
                    <c:FW_ProductsDiscountManagerSingleResult aura:id="singleProduct" product="{!product}"/>
                </aura:iteration>
            </div>
        </aura:if>
    </lightning:card>

    <c:FW_CustomToast aura:id="customToast"/>
</aura:component>
